{"version":3,"file":"static/js/957.d0a774fd.chunk.js","mappings":"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","sources":["picture/flaggreen.svg","picture/flagred.svg","views/ShareMap.js","views/Post.js"],"sourcesContent":["var _style, _path;\nvar _excluded = [\"title\", \"titleId\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from \"react\";\nfunction SvgFlaggreen(_ref, svgRef) {\n  var title = _ref.title,\n    titleId = _ref.titleId,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: \"1em\",\n    viewBox: \"0 0 448 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _style || (_style = /*#__PURE__*/React.createElement(\"style\", null, \"svg{fill:#00ff00}\")), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z\"\n  })));\n}\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFlaggreen);\nexport default __webpack_public_path__ + \"static/media/flaggreen.0d04a2a14a4cda256aa08ab3061b4a28.svg\";\nexport { ForwardRef as ReactComponent };","var _style, _path;\nvar _excluded = [\"title\", \"titleId\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from \"react\";\nfunction SvgFlagred(_ref, svgRef) {\n  var title = _ref.title,\n    titleId = _ref.titleId,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    height: \"1em\",\n    viewBox: \"0 0 448 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _style || (_style = /*#__PURE__*/React.createElement(\"style\", null, \"svg{fill:#ff0000}\")), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z\"\n  })));\n}\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgFlagred);\nexport default __webpack_public_path__ + \"static/media/flagred.7ce369b6a269d5ef47359565b2ded2dc.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useEffect, useState, useRef } from 'react';\r\nimport { GoogleMap, useLoadScript, MarkerF, PolylineF } from '@react-google-maps/api';\r\nimport { useParams } from 'react-router-dom';\r\nimport { Modal, Image } from 'antd';\r\nimport axios from 'axios';\r\nimport '../assets/styles/share.css';\r\nimport startMarker from '../picture/flaggreen.svg'\r\nimport stopMarker from '../picture/flagred.svg'\r\n\r\nconst ShareMap = ({ pathId }) => {\r\n//   const { pathId } = useParams();\r\n  const [path, setPath] = useState(null);\r\n  const [markers, setMarkers] = useState([]);\r\n  const [mapZoom, setMapZoom] = useState(15);\r\n  const [isMarkersReady, setIsMarkersReady] = useState(false);\r\n\r\n  const markerText = useRef(\"\");\r\n\r\n  const { isLoaded } = useLoadScript({\r\n    googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\r\n  });\r\n\r\n  const apiUrl = process.env.REACT_APP_API_BASE_URL;\r\n\r\n  useEffect(() => {\r\n    axios.get(`${apiUrl}/api/share/${pathId}`)\r\n      .then(response => {\r\n        setPath(response.data.data);\r\n        console.log(\"Successfully retrive shared path:\", response.data.data);\r\n      })\r\n      .catch(error => {\r\n        console.error('Error retrieving shared path:', error);\r\n      });\r\n    // get markers binded with the path\r\n    axios.get(`${apiUrl}/api/share/marker/${pathId}`)\r\n      .then(response => {\r\n        console.log(response.data.data);\r\n        const markersData = response.data.data;\r\n        Promise.all(markersData.map(marker => {\r\n          return axios.get(`${apiUrl}/api/icon/${marker.icon}`)\r\n            .then(response => {\r\n              // ... (existing code to handle marker icon response)\r\n              if (response.data.code === '0') {\r\n                console.log('Marker data get successfully', response.data);\r\n                const imageBase64 = response.data.data;\r\n                const imageUrl = `data:image/png;base64,${imageBase64}`;\r\n                const customMarkerIcon = {\r\n                  url: imageUrl,\r\n                  scaledSize: new window.google.maps.Size(64, 64)\r\n                };\r\n                marker.url = customMarkerIcon;\r\n              }\r\n            })\r\n            .catch(error => {\r\n              console.log('Error getting marker icon from the backend:', error);\r\n            });\r\n        })).then(() => {\r\n          setMarkers(markersData);\r\n          setIsMarkersReady(true);; // Markers and icons are now ready\r\n        })\r\n      })\r\n      .catch(error => {\r\n        console.error('Error retrieving shared markers:', error);\r\n      });\r\n  }, [pathId]);\r\n\r\n  // TODO\r\n  const handleMarkerClick = (marker) => {\r\n    console.log(\"marker text is:\" + marker.text);\r\n    markerText.current = marker.text;\r\n\r\n    // 预先加载图片数据\r\n    const promises = marker.picture.map(pictureID => {\r\n      return axios.get(`${apiUrl}/api/picture/${pictureID}`)\r\n        .then((response) => {\r\n          if (response.data.code === '0') {\r\n            return response.data.data;\r\n          } else {\r\n            console.log(\"Picture not found\");\r\n            return null;\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error fetching picture data:', error);\r\n          return null;\r\n        });\r\n    });\r\n\r\n    // 等待所有图片数据加载完成后再打开 Modal\r\n    Promise.all(promises)\r\n      .then((imageBase64Array) => {\r\n        // 过滤掉加载失败的图片数据\r\n        const filteredImageBase64Array = imageBase64Array.filter(imageBase64 => imageBase64 !== null);\r\n        // 打开 Modal\r\n        openModal(marker, filteredImageBase64Array);\r\n      });\r\n  };\r\n\r\n  const MarkerModalContent = ({\r\n    marker,\r\n    pictureDataGroup,\r\n    inputText,\r\n  }) => {\r\n    return (\r\n      <div>\r\n        <div>\r\n          Text: {markerText.current}\r\n        </div>\r\n        <br></br>\r\n        Pictures:\r\n        <div>\r\n          <Image.PreviewGroup\r\n            preview={{\r\n              onChange: (current, prev) => console.log(`current index: ${current}, prev index: ${prev}`),\r\n            }}\r\n          >\r\n            {pictureDataGroup.map((pictureData, index) => (\r\n              <Image key={index} width={100} src={`data:image/png;base64,${pictureData}`} />\r\n            ))}\r\n          </Image.PreviewGroup>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const openModal = (marker, imageBase64Array) => {\r\n    Modal.confirm({\r\n      title: 'The marker you left in this place',\r\n      content: <MarkerModalContent\r\n        key={new Date().getTime()} // 强制更新\r\n        marker={marker}\r\n        pictureDataGroup={imageBase64Array}\r\n      />,\r\n      onOk: (close) => {\r\n        close()\r\n      },\r\n    });\r\n  };\r\n\r\n\r\n  if (!path || !isMarkersReady || !isLoaded) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  const mapCenter = {\r\n    lat: path.path[0].lat,\r\n    lng: path.path[0].lng,\r\n  };\r\n\r\n  const pathArray = path.path;\r\n\r\n  const startPosition = pathArray[0];\r\n  const stopPosition = pathArray[pathArray.length - 1];\r\n\r\n  if (!isLoaded) return <div>Loading..</div>\r\n\r\n  return (\r\n    <div className=\"map-view\">\r\n      <div className=\"map-container\">\r\n        {isMarkersReady && isLoaded && ( // Check if markers are ready and Google Map is loaded\r\n          <GoogleMap\r\n            center={mapCenter}\r\n            zoom={mapZoom}\r\n            mapContainerClassName=\"map-container\"\r\n          >\r\n            <PolylineF\r\n              path={pathArray}\r\n              options={{\r\n                strokeColor: '#5900FF',\r\n                strokeOpacity: 1.0,\r\n                strokeWeight: 5,\r\n              }}\r\n            />\r\n\r\n            {markers.map(marker => (\r\n              <MarkerF\r\n                key={marker.id} // Assuming there's a unique id for each marker\r\n                position={{ lat: marker.markerLat, lng: marker.markerLng }}\r\n                icon={marker.url}\r\n                onClick={() => handleMarkerClick(marker)}\r\n              />\r\n            ))}\r\n\r\n            <MarkerF\r\n              position={startPosition}\r\n              icon={{\r\n                url: startMarker,\r\n                scaledSize: new window.google.maps.Size(32, 32), // Adjust the size as needed\r\n                anchor: new window.google.maps.Point(0, 32)\r\n              }}\r\n            />\r\n\r\n            <MarkerF\r\n              position={stopPosition}\r\n              icon={{\r\n                url: stopMarker,\r\n                scaledSize: new window.google.maps.Size(32, 32), // Adjust the size as needed\r\n              }}\r\n            />\r\n          </GoogleMap>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShareMap;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { Button, Input, Avatar, Typography, List, message, Image } from 'antd';\r\nimport ShareMap from './ShareMap';\r\nimport axios from 'axios';\r\nimport '../assets/styles/post.css';\r\n\r\nconst { Title, Paragraph } = Typography;\r\n\r\nexport default function Post() {\r\n  let userStr = localStorage.getItem(\"user\") || \"{}\"\r\n  let user = JSON.parse(userStr);\r\n  const apiUrl = process.env.REACT_APP_API_BASE_URL;\r\n  const { postId } = useParams(); // Get the postId from the URL parameters\r\n  // State to store the reply text\r\n  const [replyText, setReplyText] = useState('');\r\n  const [post, setPost] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  const position = 'bottom';\r\n  const align = 'center';\r\n\r\n  const [comments, setComments] = useState([]);\r\n\r\n  const fetchPost = () => {\r\n      // Make an API call to fetch the user data, including the avatarUrl\r\n      axios.get(`${apiUrl}/api/post/${postId}`)\r\n        .then((response) => {\r\n          if (response.data.code === '0') {\r\n            console.log(response.data);\r\n            const postData = response.data.data;\r\n            const commentData = response.data.data.comments ?? [];\r\n\r\n          // Fetch the user avatar for the post\r\n          const fetchPostAvatar = axios\r\n            .get(`${apiUrl}/img/${postData.avatarid}`)\r\n            .then((avatarResponse) => {\r\n              if (avatarResponse.data.code === '0') {\r\n                const avatarData = avatarResponse.data.data;\r\n                postData.avatar = `data:image/png;base64,${avatarData}`;\r\n              }\r\n            })\r\n            .catch((error) => {\r\n              console.error('Error fetching post avatar:', error);\r\n            });\r\n\r\n            // Fetch the user avatar for each post and update the data array\r\n            const fetchCommentAvatars = commentData.map((comment) => {\r\n              return axios\r\n                .get(`${apiUrl}/api/avatar/${comment.userid}`)\r\n                .then((avatarResponse) => {\r\n                  if (avatarResponse.data.code === '0') {\r\n                      const avatarData = avatarResponse.data.data;\r\n                      comment.avatar = `data:image/png;base64,${avatarData}`;\r\n                    }\r\n                })\r\n                .catch((error) => {\r\n                  console.error('Error fetching user avatar:', error);\r\n                });\r\n            });\r\n            // Wait for all the avatar fetch calls to finish before updating the data array\r\n            Promise.all([fetchPostAvatar, ...fetchCommentAvatars])\r\n              .then(() => {\r\n                // Sort the posts by createdAt in descending order (newest first)\r\n                commentData.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));\r\n                setPost(postData);\r\n                setComments(commentData);\r\n              })\r\n              .catch((error) => {\r\n                console.error('Error fetching user avatars:', error);\r\n              });\r\n          } else {\r\n            console.log(response.data.msg);\r\n          }\r\n          setIsLoading(false);\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error fetching post data:', error);\r\n          setIsLoading(false);\r\n        });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPost();\r\n  }, []);\r\n\r\n  // Function to handle reply submission\r\n  const handleReplySubmit = () => {\r\n    const newComment = {\r\n      content: replyText,\r\n      userid: user.id, // You can get the username from your user object\r\n      username: user.username,\r\n      avatarid: user.avatarUrl,\r\n    };\r\n\r\n    // Make a POST request to the backend to save the new comment\r\n    axios.post(`${apiUrl}/api/post/${postId}/reply`, newComment)\r\n      .then((response) => {\r\n        // Handle successful response, for example, show a success message\r\n        console.log(response.data);\r\n        message.success('Reply added successfully!');\r\n        // Reset the replyText after submission\r\n        setReplyText('');\r\n        fetchPost();\r\n      })\r\n      .catch((error) => {\r\n        // Handle error, for example, show an error message\r\n        console.error('Error adding reply:', error);\r\n        message.error('Failed to add reply. Please try again later.');\r\n      });\r\n  };\r\n\r\n  // Conditional rendering based on the post state\r\n  if (isLoading || !post) {\r\n    return <div>Loading...</div>; // Show a loading indicator while fetching data\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className='post-title' style={{ textAlign: 'left' }}>\r\n        <Title level={2}>{post.title}</Title>\r\n      </div>\r\n      <div className='avatar-info-container' style={{ display: 'flex', alignItems: 'center' }}>\r\n        <div className='avatar-container' style={{ marginRight: '16px' }}>\r\n          <Avatar src={post.avatar} size={64} />\r\n        </div>\r\n        <div className='post-username'>\r\n          <Title level={4}>{post.username}</Title>\r\n        </div>\r\n      </div>\r\n      <div className='post-content' style={{ textAlign: 'left' }}>\r\n        <Paragraph>{post.content}</Paragraph>\r\n      </div>\r\n      <div className='post-map'>\r\n        <ShareMap pathId={post.pathid}/>\r\n      </div>\r\n      <Input.TextArea\r\n        value={replyText}\r\n        onChange={(e) => setReplyText(e.target.value)}\r\n        rows={4}\r\n        placeholder=\"Enter your reply...\"\r\n      />\r\n      <div className='post-button'>\r\n        <Button onClick={handleReplySubmit}>Reply</Button>\r\n      </div>\r\n      {comments.length === 0 ? (\r\n        <div className='post-noreply'> No replies yet </div>\r\n      ) : (\r\n      <List\r\n        pagination={{\r\n          position,\r\n          align,\r\n        }}\r\n        dataSource={comments}\r\n        renderItem={(comment) => (\r\n          <List.Item>\r\n            <List.Item.Meta\r\n              avatar={\r\n                <Avatar src={comment.avatar} />\r\n              }\r\n              title={comment.username}\r\n              description={comment.content}\r\n            />\r\n          </List.Item>\r\n        )}\r\n      />\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":["_ref","pathId","_useState","useState","_useState2","_slicedToArray","path","setPath","_useState3","_useState4","markers","setMarkers","_useState5","_useState6","mapZoom","_useState7","_useState8","isMarkersReady","setIsMarkersReady","markerText","useRef","isLoaded","useLoadScript","googleMapsApiKey","process","apiUrl","useEffect","axios","get","concat","then","response","data","console","log","catch","error","markersData","Promise","all","map","marker","icon","code","imageBase64","customMarkerIcon","url","scaledSize","window","google","maps","Size","MarkerModalContent","_ref2","pictureDataGroup","inputText","_jsxs","children","current","_jsx","Image","PreviewGroup","preview","onChange","prev","pictureData","index","width","src","openModal","imageBase64Array","Modal","confirm","title","content","Date","getTime","onOk","close","mapCenter","lat","lng","pathArray","startPosition","stopPosition","length","className","GoogleMap","center","zoom","mapContainerClassName","PolylineF","options","strokeColor","strokeOpacity","strokeWeight","MarkerF","position","markerLat","markerLng","onClick","text","promises","picture","pictureID","filteredImageBase64Array","filter","handleMarkerClick","id","startMarker","anchor","Point","stopMarker","Title","Typography","Paragraph","Post","userStr","localStorage","getItem","user","JSON","parse","postId","useParams","replyText","setReplyText","post","setPost","isLoading","setIsLoading","comments","setComments","fetchPost","_response$data$data$c","postData","commentData","fetchPostAvatar","avatarid","avatarResponse","avatarData","avatar","fetchCommentAvatars","comment","userid","_toConsumableArray","sort","a","b","createdAt","msg","style","textAlign","level","display","alignItems","marginRight","Avatar","size","username","ShareMap","pathid","Input","TextArea","value","e","target","rows","placeholder","Button","newComment","avatarUrl","message","success","List","pagination","align","dataSource","renderItem","Item","Meta","description"],"sourceRoot":""}