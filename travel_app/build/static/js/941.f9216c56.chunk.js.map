{"version":3,"file":"static/js/941.f9216c56.chunk.js","mappings":"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","sources":["views/mapStyles.js","views/Map.js"],"sourcesContent":["export const darkMode = {\n    fullscreenControl: false,\n    streetViewControl: false,\n    styles: [\n      { elementType: \"geometry\", stylers: [{ color: \"#242f3e\" }] },\n      { elementType: \"labels.text.stroke\", stylers: [{ color: \"#242f3e\" }] },\n      { elementType: \"labels.text.fill\", stylers: [{ color: \"#746855\" }] },\n      { featureType: \"administrative.locality\", elementType: \"labels.text.fill\", stylers: [{ color: \"#d59563\" }] },\n      { featureType: \"poi\", elementType: \"labels.text.fill\", stylers: [{ color: \"#d59563\" }] },\n      { featureType: \"poi.park\", elementType: \"geometry\", stylers: [{ color: \"#263c3f\" }] },\n      { featureType: \"poi.park\", elementType: \"labels.text.fill\", stylers: [{ color: \"#6b9a76\" }] },\n      { featureType: \"road\", elementType: \"geometry\", stylers: [{ color: \"#38414e\" }] },\n      { featureType: \"road\", elementType: \"geometry.stroke\", stylers: [{ color: \"#212a37\" }] },\n      { featureType: \"road\", elementType: \"labels.text.fill\", stylers: [{ color: \"#9ca5b3\" }] },\n      { featureType: \"road.highway\", elementType: \"geometry\", stylers: [{ color: \"#746855\" }] },\n      { featureType: \"road.highway\", elementType: \"geometry.stroke\", stylers: [{ color: \"#1f2835\" }] },\n      { featureType: \"road.highway\", elementType: \"labels.text.fill\", stylers: [{ color: \"#f3d19c\" }] },\n      { featureType: \"transit\", elementType: \"geometry\", stylers: [{ color: \"#2f3948\" }] },\n      { featureType: \"transit.station\", elementType: \"labels.text.fill\", stylers: [{ color: \"#d59563\" }] },\n      { featureType: \"water\", elementType: \"geometry\", stylers: [{ color: \"#17263c\" }] },\n      { featureType: \"water\", elementType: \"labels.text.fill\", stylers: [{ color: \"#515c6d\" }] },\n      { featureType: \"water\", elementType: \"labels.text.stroke\", stylers: [{ color: \"#17263c\" }] },\n    ],\n};","import { useState, useEffect, useRef } from 'react';\r\nimport { GoogleMap, useLoadScript, MarkerF, PolylineF } from '@react-google-maps/api';\r\nimport '../App.css';\r\nimport { FloatButton, Button, Tooltip, Modal, Upload, Input, message } from 'antd';\r\nimport { useContext } from 'react';\r\nimport SavedPathsContext from '../SavedPathsContext';\r\nimport { ThemeContext } from '../App';\r\nimport { PlayCircleOutlined, StopOutlined, CompassOutlined, EyeOutlined, EyeInvisibleOutlined, PlusOutlined, ClearOutlined, DownloadOutlined, ShareAltOutlined } from '@ant-design/icons';\r\nimport html2canvas from 'html2canvas';\r\nimport Geocode from \"react-geocode\";\r\nimport { LoadingOutlined } from '@ant-design/icons';\r\nimport axios from 'axios';\r\nimport myImg from '../picture/1.jpg';\r\nimport myImg2 from '../picture/2.jpg';\r\nimport ImgCrop from 'antd-img-crop'\r\nimport TextArea from 'antd/es/input/TextArea';\r\nimport { darkMode } from './mapStyles';\r\n\r\nexport default function Map() {\r\n  const [positions, setPositions] = useState([]);\r\n  const [trackingEnabled, setTrackingEnabled] = useState(false); // State to track whether geolocation tracking is enabled\r\n  const [pathId, setPathId] = useState(0);\r\n  const [markers, setMarkers] = useState([]);\r\n  const [currentPosition, setCurrentPositions] = useState({ lat: null, lng: null });\r\n  const [isPathsVisible, setIsPathsVisible] = useState(true);\r\n  const [mapCenter, setMapCenter] = useState(null);\r\n  const [mapZoom, setMapZoom] = useState(14);\r\n  const [startTime, setStartTime] = useState(null);\r\n  const [endTime, setEndTime] = useState(null);\r\n  const [markerName, setMarkerName] = useState(1);\r\n\r\n  const apiUrl = process.env.REACT_APP_API_BASE_URL;\r\n\r\n  const pathName = useRef(\"\");\r\n  const inputText = useRef(\"\");\r\n  const markerIcon = useRef(\"\");\r\n  // State to store the user's avatarUrl\r\n  const markerIconDataUrl = useRef(\"\");\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [imageUrl, setImageUrl] = useState();\r\n\r\n  const { addPath, displayedPath, setDisplayedPath } = useContext(SavedPathsContext);\r\n  const { theme } = useContext(ThemeContext);\r\n\r\n  const getBase64 = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = () => resolve(reader.result);\r\n      reader.onerror = (error) => reject(error);\r\n    });\r\n  };\r\n\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const [previewImage, setPreviewImage] = useState(\"\");\r\n\r\n\r\n  const handleCancel = () => setPreviewOpen(false);\r\n\r\n  const customRequest = async ({ file, onSuccess, onError }) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      // Change the URL to your backend endpoint that handles the avatar upload\r\n      const response = await axios.post(`${apiUrl}/api/upload-icon`, formData);\r\n      if (response.data.code === '0') {\r\n        // Save the file URL or file ID returned by the backend in your state or user profile\r\n        console.log('Icon uploaded successfully:', response.data);\r\n        console.log(response.data.data)\r\n        markerIcon.current = response.data.data;\r\n        console.log(markerIcon.current)\r\n        onSuccess();\r\n      } else {\r\n        onError(new Error('Failed to upload icon'));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error uploading avatar:', error);\r\n      onError(error);\r\n    }\r\n  };\r\n\r\n  const handlePreview = async (file) => {\r\n    if (!file.url && !file.preview) {\r\n      file.preview = await getBase64(file.originFileObj);\r\n    }\r\n\r\n    setPreviewImage(file.url || file.preview);\r\n    setPreviewOpen(true);\r\n  };\r\n\r\n  const { isLoaded } = useLoadScript({\r\n    googleMapsApiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\r\n  });\r\n\r\n  const [isTakingScreenshot, setIsTakingScreenshot] = useState(false);\r\n\r\n\r\n  const uploadButton = (\r\n    <div>\r\n      {loading ? <LoadingOutlined /> : <PlusOutlined />}\r\n      <div style={{ marginTop: 8 }}>Upload</div>\r\n    </div>\r\n  );\r\n\r\n  // const handleChange = ({ file, fileList: newFileList }) => {\r\n  //   if (file.status === 'uploading') {\r\n  //     setLoading(true);\r\n  //     return;\r\n  //   }\r\n  //   if (file.status === 'done') {\r\n  //     // Get this url from response in real world.\r\n  //     setImageUrl(URL.createObjectURL(file.originFileObj));\r\n  //     setLoading(false);\r\n  //   }\r\n  // };\r\n  const handleChange = (info) => {\r\n    if (info.file.status === 'done') {\r\n      message.success(`${info.file.name} uploaded successfully`);\r\n    } else if (info.file.status === 'error') {\r\n      message.error(`${info.file.name} upload failed.`);\r\n    }\r\n  };\r\n\r\n  function getLocation() {\r\n    return new Promise((resolve, reject) => {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          const { latitude, longitude } = position.coords;\r\n          resolve({ latitude, longitude });\r\n        },\r\n        (error) => {\r\n          reject(error);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n\r\n  async function getAvgLocation(pathId) {\r\n\r\n    await new Promise((resolve) => {\r\n      setTimeout(function () {\r\n        resolve();\r\n      }, 1000);\r\n    });\r\n\r\n    const { latitude: firstLat, longitude: firstLng } = await getLocation();\r\n    console.log({ firstLat, firstLng });\r\n\r\n    await new Promise((resolve) => {\r\n      setTimeout(function () {\r\n        resolve();\r\n      }, 1000);\r\n    });\r\n\r\n    const { latitude: secondLat, longitude: secondLng } = await getLocation();\r\n    console.log({ secondLat, secondLng });\r\n\r\n    await new Promise((resolve) => {\r\n      setTimeout(function () {\r\n        resolve();\r\n      }, 1000);\r\n    });\r\n\r\n    const { latitude: thirdLat, longitude: thirdLng } = await getLocation();\r\n    console.log({ thirdLat, thirdLng });\r\n\r\n    const position = {\r\n      latitude: (firstLat + secondLat + thirdLat) / 3.0,\r\n      longitude: (firstLng + secondLng + thirdLng) / 3.0\r\n    }\r\n\r\n    setPositions((prev) => [...prev, { lat: position.latitude, lng: position.longitude, type: \"default\", pathId }]);\r\n    setCurrentPositions({ lat: position.latitude, lng: position.longitude });\r\n\r\n    console.log(position);\r\n    setEndTime(new Date()); // Save the end time\r\n  }\r\n\r\n\r\n  // Get the user's current location\r\n  useEffect(() => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          // Set the default map center to the user's current location\r\n          setMapCenter({\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude,\r\n          });\r\n        },\r\n        (error) => {\r\n          console.error(\"Error retrieving geolocation:\", error);\r\n          // If can't get the user's current location, the set to a default location\r\n          setMapCenter({ lat: 40.7128, lng: -74.0060 }); // Anywhere can be changed later\r\n        }\r\n      );\r\n    } else {\r\n      // If the web browser doesn't support geolocation, also set a default center\r\n      setMapCenter({ lat: 40.7128, lng: -74.0060 });\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (displayedPath && displayedPath.length > 0) {\r\n      // If there is a path to display, set the center point of the map to the first point of the displayed path\r\n      setMapCenter(displayedPath[0]);\r\n      setMapZoom(15);\r\n    } else if (positions.length > 0) {\r\n      // If there is no path to display, but is under tracking, set the center point of the map as the last tracked point\r\n      setMapCenter(positions[positions.length - 1]);\r\n    }\r\n    // If the geolocation cannot be obtained or there is no path being tracked, keep the center point unchanged\r\n  }, [displayedPath, positions]);\r\n\r\n  useEffect(() => {\r\n    let interval;\r\n\r\n    if (trackingEnabled) {\r\n      setStartTime(new Date()); // Save the start time\r\n      // Immediately get the current location\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          const { latitude, longitude } = position.coords;\r\n          setPositions((prev) => [...prev, { lat: latitude, lng: longitude, type: \"default\", pathId }]);\r\n          setCurrentPositions({ lat: latitude, lng: longitude });\r\n          console.log(\"Got first location after click the button\");\r\n        },\r\n        (error) => {\r\n          console.error('Error retrieving geolocation:', error);\r\n        }\r\n      );\r\n\r\n      // Start tracking location every 10 seconds\r\n      interval = setInterval(async () => {\r\n        console.log(\"Start Marking\");\r\n        await getAvgLocation(pathId);\r\n        console.log(\"Get a location\");\r\n        console.log(pathId);\r\n\r\n      }, 8000);\r\n    }\r\n\r\n    // Cleanup function to clear interval when component unmounts\r\n    return () => clearInterval(interval);\r\n  }, [trackingEnabled, pathId]);\r\n\r\n  const handleStartTracking = () => {\r\n    setPositions([]); // clear positions before a new tracking\r\n    setMarkers([]);\r\n    setTrackingEnabled(true);\r\n    setPathId(prevPathId => prevPathId + 1); // 使用回调函数更新 pathId\r\n    console.log(\"Start tracking\");\r\n  };\r\n\r\n  //TODO\r\n  const handleAddPoint = () => {\r\n    const { lat, lng } = currentPosition;\r\n\r\n    Modal.confirm({\r\n      title: 'Set a New Marker',\r\n      content: (\r\n        <div>\r\n          Marker icon:\r\n          <ImgCrop\r\n            rotationSlider={true}\r\n            zoomSlider={true}\r\n            quality={1}\r\n            cropShape='round'\r\n          >\r\n\r\n            <Upload\r\n              customRequest={customRequest}\r\n              listType=\"picture-circle\"\r\n              onPreview={handlePreview}\r\n              onChange={handleChange}\r\n            >\r\n              {uploadButton}\r\n\r\n            </Upload>\r\n\r\n          </ImgCrop>\r\n\r\n          Comment:\r\n\r\n          <TextArea\r\n            showCount\r\n            maxLength={200}\r\n            style={{ heght: 250, marginBottom: 24 }}\r\n            placeholder=\"Input something...\"\r\n            onChange={(e) => inputText.current = e.target.value}\r\n          />\r\n\r\n          Pictures:\r\n          <ImgCrop>\r\n            <Upload\r\n              listType=\"picture-card\"\r\n              onPreiew={handlePreview}\r\n              onChange={handleChange}\r\n            >\r\n              {imageUrl ? <img src={imageUrl} alt=\"avatar\" style={{ width: '100%' }} /> : uploadButton}\r\n            </Upload>\r\n          </ImgCrop>\r\n\r\n        </div>\r\n      ),\r\n      onOk: (close) => {\r\n\r\n        axios.get(`${apiUrl}/api/icon/${markerIcon.current}`)\r\n          .then((response) => {\r\n            if (response.data.code === '0') {\r\n              console.log(response.data.data);\r\n              const imageBase64 = response.data.data;\r\n              // Set the userAvatarUrl state with the fetched avatar data\r\n              markerIconDataUrl.current = `data:image/png;base64,${imageBase64}`;\r\n              console.log(markerIconDataUrl.current)\r\n\r\n              const customMarkerIcon = {\r\n                url: markerIconDataUrl.current, // your base64 data url\r\n                scaledSize: new google.maps.Size(64, 64) // the size you want to scale to\r\n              };\r\n\r\n              const newMarker = {\r\n                markerLat: lat,\r\n                markerLng: lng,\r\n                type: \"custom\",\r\n                markerID: Date.now(), // Assign a unique ID to the marker\r\n                name: markerName,\r\n                text: inputText.current,\r\n                url: customMarkerIcon, // Only for display, will not stored in database\r\n                icon: markerIcon.current,\r\n                pathID: \"\"\r\n              };\r\n\r\n              console.log(newMarker);\r\n\r\n              setMarkers((prev) => [...prev, newMarker]);\r\n              setMarkerName(markerName + 1);\r\n              console.log(\"Add an information point\");\r\n\r\n            } else {\r\n              console.log(\"Icon not found\");\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            console.error('Error fetching icon data:', error);\r\n          });\r\n\r\n\r\n        close();\r\n      },\r\n    });\r\n  };\r\n\r\n  Geocode.setApiKey(process.env.REACT_APP_GOOGLE_MAPS_API_KEY);\r\n\r\n  const handleStopTracking = () => {\r\n    setTrackingEnabled(false);\r\n    console.log(\"Stop tracking\");\r\n\r\n    const duration = (endTime - startTime) / 1000; // Calculate the duration in seconds\r\n    if (duration < 10) {\r\n      Modal.warning({\r\n        centered: true,\r\n        title: 'Warning',\r\n        content: 'The path is less than 10 seconds long and will not be saved.',\r\n      });\r\n      return;\r\n    }\r\n\r\n    Modal.confirm({\r\n      centered: true,\r\n      title: 'Do you want to save this path?',\r\n      content: (\r\n        <div>\r\n          <p>Enter a name for the path:</p>\r\n          <Input\r\n            onChange={(e) => {\r\n              pathName.current = e.target.value;\r\n            }}\r\n            placeholder=\"Path name\"\r\n          />\r\n        </div>\r\n      ),\r\n      onOk: () => {\r\n        console.log(pathName);\r\n        const startCoordinates = positions[0];\r\n        const endCoordinates = positions[positions.length - 1];\r\n        // Get the user info stored in sessionStorage\r\n        const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n\r\n        // 使用逆地理编码服务获取开始点的地址\r\n        Geocode.fromLatLng(startCoordinates.lat, startCoordinates.lng)\r\n          .then((response) => {\r\n            const startAddress = response.results[0].formatted_address;\r\n\r\n            // 使用逆地理编码服务获取结束点的地址\r\n            Geocode.fromLatLng(endCoordinates.lat, endCoordinates.lng)\r\n              .then((response) => {\r\n                const endAddress = response.results[0].formatted_address;\r\n\r\n                const pathData = {\r\n                  path: positions,\r\n                  startTime: startTime,\r\n                  endTime: endTime,\r\n                  duration: duration,\r\n                  startAddress: startAddress,\r\n                  endAddress: endAddress,\r\n                  userid: user.id,\r\n                  name: pathName.current,\r\n                };\r\n\r\n                console.log(\"PathData\", pathData);\r\n\r\n                //send pathData to back end\r\n                axios.post(`${apiUrl}/api/path-data`, pathData)\r\n                  .then(response => {\r\n                    // Check the response code\r\n                    if (response.data.code === '0') {\r\n                      console.log('Path data successfully sent to the backend:', response.data);\r\n                    }\r\n                    // Get pathId from back end\r\n                    console.log(response.data.data);\r\n                    const updatedMarkers = markers.map(item => ({ ...item, pathID: response.data.data }))\r\n\r\n                    // send markerData to back end\r\n                    updatedMarkers.forEach(marker => {\r\n                      console.log(marker)\r\n                      axios.post(`${apiUrl}/api/marker-data`, marker)\r\n                        .then(response => {\r\n                          if (response.data.code === '0') {\r\n                            console.log('Marker data successfully sent to backend:', response.data);\r\n                          }\r\n                        })\r\n                        .catch(error => {\r\n                          console.log('Error sending marker data to the backend:', error);\r\n                        });\r\n                    })\r\n\r\n                  })\r\n                  .catch(error => {\r\n                    console.error('Error sending path data to the backend:', error);\r\n                  });\r\n                //save pathData at front end\r\n                addPath(pathData);\r\n              })\r\n              .catch((error) => {\r\n                console.error(\"Error geocoding end coordinates:\", error);\r\n              });\r\n          })\r\n          .catch((error) => {\r\n            console.error(\"Error geocoding start coordinates:\", error);\r\n          });\r\n      },\r\n      // No action on cancel, as we just close the modal\r\n    });\r\n  };\r\n\r\n  // TODO\r\n  const handleMarkerClick = (marker) => {\r\n    console.log(\"marker text is:\" + marker.text)\r\n    Modal.confirm({\r\n      title: 'The comment you left in this place',\r\n      content: (\r\n        <div>\r\n\r\n          <TextArea\r\n            showCount\r\n            maxLength={200}\r\n            style={{ heght: 250, marginBottom: 24 }}\r\n            placeholder=\"Input something...\"\r\n            defaultValue={marker.text}\r\n            onChange={(e) => inputText.current = e.target.value}\r\n          />\r\n          Pictures:\r\n          <ImgCrop>\r\n            <Upload\r\n              listType=\"picture-card\"\r\n              onPreiew={handlePreview}\r\n              onChange={handleChange}\r\n            >\r\n            </Upload>\r\n            {imageUrl ? <img src={imageUrl} alt=\"avatar\" style={{ width: '100%' }} /> : uploadButton}\r\n          </ImgCrop>\r\n\r\n\r\n        </div>\r\n      ),\r\n      onOk: (close) => {\r\n\r\n        const newMarker = {\r\n          lat: marker.lat,\r\n          lng: marker.lng,\r\n          type: \"custom\",\r\n          id: marker.id, // Assign a unique ID to the marker\r\n          name: marker.name,\r\n          text: inputText.current,\r\n          icon: marker.icon\r\n        };\r\n\r\n\r\n\r\n        setMarkers(markers.map(m => m === marker ? newMarker : m))\r\n        close();\r\n      },\r\n    });\r\n  };\r\n\r\n\r\n  // Group positions by pathId\r\n  const positionByPathId = positions.reduce((acc, position) => {\r\n    (acc[position.pathId] = acc[position.pathId] || []).push(position);\r\n    return acc;\r\n  }, {});\r\n\r\n  const handleClearPaths = () => {\r\n    // setClearedPaths(positions);\r\n    setPositions([]);\r\n    setMarkers([]);\r\n    setMarkerName(1);\r\n    setPathId(0);\r\n    setDisplayedPath([]);\r\n  }\r\n\r\n  const togglePathsVisibility = () => {\r\n    setIsPathsVisible(!isPathsVisible);\r\n  };\r\n\r\n\r\n\r\n  const handleScreenshot = async () => {\r\n    setIsTakingScreenshot(true);\r\n\r\n    const mapContainer = document.querySelector('.map-container');\r\n\r\n    html2canvas(mapContainer, { useCORS: true, allowTaint: true }).then((canvas) => {\r\n      const link = document.createElement('a');\r\n      link.href = canvas.toDataURL('image/png');\r\n      link.download = 'screenshot.png';\r\n      link.click();\r\n\r\n      setIsTakingScreenshot(false);\r\n    });\r\n  };\r\n\r\n  const handleShareScreenshot = async () => {\r\n    setIsTakingScreenshot(true);\r\n\r\n    const mapContainer = document.querySelector('.map-container');\r\n\r\n    html2canvas(mapContainer, { useCORS: true, allowTaint: true }).then((canvas) => {\r\n      const blob = canvas.toBlob((blob) => {\r\n        if (blob) {\r\n          const file = new File([blob], 'screenshot.png', { type: 'image/png' });\r\n\r\n          if (navigator.share) {\r\n            // Share the screenshot using the Web Share API\r\n            navigator.share({\r\n              files: [file],\r\n            });\r\n          } else {\r\n            console.error('Web Share API not supported.');\r\n          }\r\n        } else {\r\n          console.error('Failed to generate screenshot blob.');\r\n        }\r\n\r\n        setIsTakingScreenshot(false);\r\n      });\r\n    });\r\n  };\r\n\r\n  if (!isLoaded) return <div>Loading..</div>\r\n\r\n  return (\r\n    /*global google*/\r\n    <div className=\"map-view\">\r\n      <div className=\"map-container\">\r\n        <GoogleMap\r\n          center={mapCenter}\r\n          zoom={mapZoom}\r\n          mapContainerClassName=\"map-container\"\r\n          options={{\r\n            fullscreenControl: false,\r\n            streetViewControl: false,\r\n            ...theme === 'default' ? {} : darkMode,\r\n          }}\r\n        >\r\n          {isPathsVisible && Object.values(positionByPathId).map((pathPositions, index) => (\r\n            <PolylineF\r\n              key={index}\r\n              path={pathPositions}\r\n              options={{\r\n                strokeColor: '#0000FF',\r\n                strokeOpacity: 1.0,\r\n                strokeWeight: 5,\r\n              }}\r\n            />\r\n          ))}\r\n\r\n          {displayedPath && isPathsVisible && ( // Display the saved path\r\n            <PolylineF\r\n              path={displayedPath}\r\n              options={{\r\n                strokeColor: '#FF0000',\r\n                strokeOpacity: 1.0,\r\n                strokeWeight: 5,\r\n              }}\r\n            />\r\n          )}\r\n\r\n          {markers.map((marker, index) => (\r\n            <MarkerF\r\n              key={marker}\r\n              position={{ lat: marker.markerLat, lng: marker.markerLng }}\r\n              visible={marker.type === 'custom'}\r\n              icon={marker.url}\r\n\r\n              onClick={() => handleMarkerClick(marker)}\r\n            />\r\n          ))}\r\n        </GoogleMap>\r\n\r\n        {/* Main start/stop button */}\r\n        <div className='map-view-start-stop-button'>\r\n          {trackingEnabled ? (\r\n            <Button\r\n              type=\"primary\"\r\n              shape=\"round\"\r\n              size=\"large\"\r\n              onClick={handleStopTracking}\r\n              icon={<StopOutlined />}\r\n              style={{ backgroundColor: 'OrangeRed' }}\r\n            >\r\n              STOP\r\n            </Button>\r\n          ) : (\r\n            <Button\r\n              type=\"primary\"\r\n              shape=\"round\"\r\n              size=\"large\"\r\n              onClick={handleStartTracking}\r\n              icon={<PlayCircleOutlined />}\r\n              style={{ backgroundColor: 'LimeGreen' }}\r\n            >\r\n              START\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Text location information and back to top button*/}\r\n        <FloatButton.Group shape=\"circle\" style={{ left: 24 }}>\r\n          <Tooltip\r\n            title={\r\n              <div>\r\n                <h1>Your current location:</h1>\r\n                <p>Latitude: {currentPosition.lat} </p>\r\n                <p>Longitude: {currentPosition.lng}</p>\r\n              </div>\r\n            }\r\n            placement='right'\r\n            color='#87d068'\r\n          >\r\n            <FloatButton\r\n              icon={<CompassOutlined />}\r\n            />\r\n          </Tooltip>\r\n\r\n          <FloatButton.BackTop visibilityHeight={0} />\r\n        </FloatButton.Group>\r\n\r\n\r\n        {/* Functional buttons group */}\r\n        <FloatButton.Group shape=\"circle\" style={{ right: 50, top: '60%', transform: 'translateY(-50%)' }}>\r\n          {isPathsVisible ? (\r\n            <FloatButton\r\n              icon={<EyeInvisibleOutlined />}\r\n              tooltip='Hide Paths'\r\n              onClick={togglePathsVisibility}\r\n            />\r\n          ) : (\r\n            <FloatButton\r\n              icon={<EyeOutlined />}\r\n              tooltip='Show Paths'\r\n              onClick={togglePathsVisibility}\r\n            />\r\n          )}\r\n\r\n          <FloatButton\r\n            icon={<PlusOutlined />}\r\n            tooltip='Add a Point'\r\n            onClick={handleAddPoint}\r\n            disabled={!trackingEnabled}\r\n          />\r\n\r\n          <FloatButton\r\n            icon={<ClearOutlined />}\r\n            tooltip='Clear'\r\n            onClick={handleClearPaths}\r\n            disabled={trackingEnabled}\r\n          />\r\n\r\n          <FloatButton\r\n            icon={<DownloadOutlined />}\r\n            tooltip=\"Take Screenshot\"\r\n            onClick={handleScreenshot}\r\n            disabled={isTakingScreenshot}\r\n          />\r\n\r\n          <FloatButton\r\n            icon={<ShareAltOutlined />}\r\n            tooltip=\"Share\"\r\n            onClick={handleShareScreenshot}\r\n            disabled={isTakingScreenshot}\r\n          />\r\n        </FloatButton.Group>\r\n\r\n      </div>\r\n\r\n    </div >\r\n  );\r\n}"],"names":["darkMode","fullscreenControl","streetViewControl","styles","elementType","stylers","color","featureType","Map","_useState","useState","_useState2","_slicedToArray","positions","setPositions","_useState3","_useState4","trackingEnabled","setTrackingEnabled","_useState5","_useState6","pathId","setPathId","_useState7","_useState8","markers","setMarkers","_useState9","lat","lng","_useState10","currentPosition","setCurrentPositions","_useState11","_useState12","isPathsVisible","setIsPathsVisible","_useState13","_useState14","mapCenter","setMapCenter","_useState15","_useState16","mapZoom","setMapZoom","_useState17","_useState18","startTime","setStartTime","_useState19","_useState20","endTime","setEndTime","_useState21","_useState22","markerName","setMarkerName","apiUrl","process","pathName","useRef","inputText","markerIcon","markerIconDataUrl","_useState23","_useState24","loading","_useState25","_useState26","imageUrl","_useContext","useContext","SavedPathsContext","addPath","displayedPath","setDisplayedPath","theme","ThemeContext","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","_useState27","_useState28","setPreviewOpen","_useState29","_useState30","setPreviewImage","customRequest","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","onSuccess","onError","formData","response","wrap","_context","prev","next","FormData","append","axios","post","concat","sent","data","code","console","log","current","Error","t0","stop","_x","apply","arguments","handlePreview","_ref3","_callee2","_context2","url","preview","originFileObj","_x2","isLoaded","useLoadScript","googleMapsApiKey","_useState31","_useState32","isTakingScreenshot","setIsTakingScreenshot","uploadButton","_jsxs","children","_jsx","LoadingOutlined","PlusOutlined","style","marginTop","handleChange","info","status","message","success","name","getLocation","navigator","geolocation","getCurrentPosition","position","_position$coords","coords","latitude","longitude","getAvgLocation","_x3","_getAvgLocation","_callee6","_yield$getLocation","firstLat","firstLng","_yield$getLocation2","secondLat","secondLng","_yield$getLocation3","thirdLat","thirdLng","_context6","setTimeout","_toConsumableArray","type","Date","useEffect","length","interval","_position$coords2","setInterval","_callee3","_context3","clearInterval","Geocode","setApiKey","positionByPathId","reduce","acc","push","togglePathsVisibility","handleScreenshot","_ref5","_callee4","mapContainer","_context4","document","querySelector","html2canvas","useCORS","allowTaint","then","canvas","link","createElement","href","toDataURL","download","click","handleShareScreenshot","_ref6","_callee5","_context5","toBlob","blob","File","share","files","className","GoogleMap","center","zoom","mapContainerClassName","options","_objectSpread","Object","values","map","pathPositions","index","PolylineF","path","strokeColor","strokeOpacity","strokeWeight","marker","MarkerF","markerLat","markerLng","visible","icon","onClick","text","Modal","confirm","title","content","TextArea","showCount","maxLength","heght","marginBottom","placeholder","defaultValue","onChange","e","target","value","ImgCrop","Upload","listType","onPreiew","src","alt","width","onOk","close","newMarker","id","m","handleMarkerClick","Button","shape","size","duration","warning","centered","Input","startCoordinates","endCoordinates","user","JSON","parse","sessionStorage","getItem","fromLatLng","startAddress","results","formatted_address","endAddress","pathData","userid","item","pathID","forEach","catch","StopOutlined","backgroundColor","prevPathId","PlayCircleOutlined","FloatButton","Group","left","Tooltip","placement","CompassOutlined","BackTop","visibilityHeight","right","top","transform","EyeInvisibleOutlined","tooltip","EyeOutlined","rotationSlider","zoomSlider","quality","cropShape","onPreview","get","imageBase64","customMarkerIcon","scaledSize","google","maps","Size","markerID","now","disabled","ClearOutlined","DownloadOutlined","ShareAltOutlined"],"sourceRoot":""}