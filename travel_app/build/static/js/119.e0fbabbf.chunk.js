"use strict";(self.webpackChunktravel_app=self.webpackChunktravel_app||[]).push([[119],{5119:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var n=a(3433),o=a(9439),r=a(2791),c=a(7462),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.9 533.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.4-65.5-111.1a67.67 67.67 0 00-34.3-9.3H572.4l6-122.9c1.4-29.7-9.1-57.9-29.5-79.4A106.62 106.62 0 00471 99.9c-52 0-98 35-111.8 85.1l-85.9 311H144c-17.7 0-32 14.3-32 32v364c0 17.7 14.3 32 32 32h601.3c9.2 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7-.2-12.6-2-25.1-5.6-37.1zM184 852V568h81v284h-81zm636.4-353l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 16.5-7.2 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 016.9 27.3c0 22.4-13.2 42.6-33.6 51.8H329V564.8l99.5-360.5a44.1 44.1 0 0142.2-32.3c7.6 0 15.1 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.2 32.1-19.6 43z"}}]},name:"like",theme:"outlined"},l=a(4291),s=function(e,t){return r.createElement(l.Z,(0,c.Z)({},e,{ref:t,icon:i}))};var d=r.forwardRef(s),u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"},f=function(e,t){return r.createElement(l.Z,(0,c.Z)({},e,{ref:t,icon:u}))};var m=r.forwardRef(f),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},v=function(e,t){return r.createElement(l.Z,(0,c.Z)({},e,{ref:t,icon:p}))};var h=r.forwardRef(v),g=a(1046),x=a(7846),Z=a(7027),j=a(8715),y=a(2962),w=a(5925),b=a(17),z=a(6005),S=a(9555),C=a(1087),E=a(1243),O=a(184),k=function(e){var t=e.icon,a=e.text;return(0,O.jsxs)(g.Z,{children:[r.createElement(t),a]})};function N(){var e=sessionStorage.getItem("user")||"{}",t=JSON.parse(e),a="https://travel-app.online:8443",c=(0,r.useState)(!0),i=(0,o.Z)(c,2),l=i[0],s=i[1],u=(0,r.useState)(!1),f=(0,o.Z)(u,2),p=f[0],v=f[1],g=x.Z.useForm(),N=(0,o.Z)(g,1)[0],P=(0,r.useState)([]),M=(0,o.Z)(P,2),I=M[0],A=M[1],D=(0,r.useState)(""),F=(0,o.Z)(D,2),L=F[0],B=F[1],G=(0,r.useState)([]),H=(0,o.Z)(G,2),R=(H[0],H[1]),V=(0,r.useState)([]),T=(0,o.Z)(V,2),_=T[0],q=T[1],U=function(){var e=window.location.protocol,t=window.location.hostname,a=window.location.port,n=a&&"80"!==a&&"443"!==a?":".concat(a):"";return"".concat(e,"//").concat(t).concat(n)}(),J=function(){s(!0),E.Z.get("".concat(a,"/api/posts")).then((function(e){if("0"===e.data.code){console.log("Successfully fetched post data",e.data.data);var t=e.data.data,o=t.map((function(e){return E.Z.get("".concat(a,"/api/avatar/").concat(e.userid)).then((function(t){if("0"===t.data.code){var a=t.data.data;e.avatar="data:image/png;base64,".concat(a)}})).catch((function(e){console.error("Error fetching user avatar:",e)}))})),r=t.map((function(e){return E.Z.get("".concat(a,"/api/screenshot/").concat(e.pathid)).then((function(t){if("0"===t.data.code){var a=t.data.data;e.screenshot="data:image/png;base64,".concat(a)}})).catch((function(e){console.error("Error fetching user screenshot:",e)}))}));Promise.all([].concat((0,n.Z)(o),(0,n.Z)(r))).then((function(){t.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})),A(t),console.log("Post Data: ",t)})).catch((function(e){console.error("Error fetching user avatars:",e)}))}else console.log("Error fetching post data:",e.data.message);s(!1)})).catch((function(e){console.error("Error fetching post data:",e),s(!1)}))},K=function(e){var t=new Date(e),a=(new Date).getTime()-t.getTime(),n=Math.floor(a/1e3),o=Math.floor(a/6e4),r=Math.floor(a/36e5),c=Math.floor(a/864e5);return c>0?"".concat(c," ").concat(1===c?"day":"days"," ago"):r>0?"".concat(r," ").concat(1===r?"hour":"hours"," ago"):o>0?"".concat(o," ").concat(1===o?"minute":"minutes"," ago"):"".concat(n," ").concat(1===n?"second":"seconds"," ago")};(0,r.useEffect)((function(){J()}),[]),(0,r.useEffect)((function(){E.Z.get("".concat(a,"/api/paths/").concat(t.id)).then((function(e){console.log(e.data),R(e.data.data);var t=e.data.data.map((function(e){return{value:e.id,label:e.name}}));q(t)})).catch((function(e){console.error("Error retrieving paths:",e)}))}),[]);return(0,O.jsxs)("div",{className:"community",children:[l?(0,O.jsx)("div",{children:"Loading..."}):(0,O.jsx)(j.Z,{itemLayout:"vertical",size:"large",pagination:{onChange:function(e){console.log(e)},pageSize:3},dataSource:I,footer:(0,O.jsxs)("div",{children:[(0,O.jsx)("b",{children:"travel app"})," footer part"]}),renderItem:function(e){return(0,O.jsx)(C.rU,{to:"/post/".concat(e.id),children:(0,O.jsxs)(j.Z.Item,{className:"post-item",actions:[(0,O.jsx)(k,{icon:d,text:"56"},"list-vertical-like-o"),(0,O.jsx)(k,{icon:m,text:e.comments.length},"list-vertical-message")],extra:e.pathid?(0,O.jsx)("a",{href:"".concat(U,"/share/").concat(e.pathid),target:"_blank",rel:"noopener noreferrer",children:(0,O.jsx)("img",{width:272,alt:"logo",src:e.screenshot,onClick:function(e){return e.stopPropagation()}})}):(0,O.jsx)("img",{width:272,alt:"logo",src:"https://gw.alipayobjects.com/zos/rmsportal/mqaQswcyDLcXyDKnZfES.png"}),children:[(0,O.jsx)("div",{children:(0,O.jsx)(j.Z.Item.Meta,{avatar:(0,O.jsx)(y.C,{src:e.avatar}),title:e.username,description:"Posted ".concat(K(e.createdAt))})}),(0,O.jsx)("div",{className:"post-content",style:{textAlign:"left"},children:e.title})]},e.title)})}}),(0,O.jsx)(w.Z.Group,{shape:"circle",style:{left:250,top:"85%",transform:"translateY(-50%)"},children:(0,O.jsx)(w.Z,{icon:(0,O.jsx)(h,{}),tooltip:"Make a Post",onClick:function(){v(!0)}})}),(0,O.jsx)(b.Z,{title:"Make a Post",open:p,onCancel:function(){v(!1)},onOk:function(){N.validateFields().then((function(e){var n={title:e.title,content:e.content,userid:t.id,username:t.username,avatarid:t.avatarUrl,pathid:L},o=new Date;n.createdAt=o.toISOString(),console.log(n),E.Z.post("".concat(a,"/api/make-post"),n).then((function(e){"0"===e.data.code?(console.log("Post saved successfully:",e.data),J()):Z.ZP.error("Failed to make a post")})).catch((function(e){console.error("Error saving post:",e)})),v(!1),N.resetFields(),B("")}))},children:(0,O.jsxs)(x.Z,{form:N,layout:"vertical",children:[(0,O.jsx)(x.Z.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please enter a title"}],children:(0,O.jsx)(z.Z,{})}),(0,O.jsx)(x.Z.Item,{label:"Content",name:"content",rules:[{required:!0,message:"Please enter the content"}],children:(0,O.jsx)(z.Z.TextArea,{})}),(0,O.jsx)(x.Z.Item,{label:"Select a path",children:(0,O.jsx)(S.Z,{showSearch:!0,style:{width:200},placeholder:"Search to Select",optionFilterProp:"children",filterOption:function(e,t){var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").includes(e)},filterSort:function(e,t){var a,n;return(null!==(a=null===e||void 0===e?void 0:e.label)&&void 0!==a?a:"").toLowerCase().localeCompare((null!==(n=null===t||void 0===t?void 0:t.label)&&void 0!==n?n:"").toLowerCase())},options:_,value:L,onChange:B})})]})})]})}},1046:function(e,t,a){a.d(t,{Z:function(){return j}});var n=a(4942),o=a(9439),r=a(1694),c=a.n(r),i=a(5501),l=a(2791),s=a(9911),d=a(1929),u=a(11),f=l.createContext({latestIndex:0,horizontalSize:0,verticalSize:0,supportFlexGap:!1}),m=f.Provider,p=function(e){var t=e.className,a=e.direction,o=e.index,r=e.marginDirection,c=e.children,i=e.split,s=e.wrap,d=e.style,u=l.useContext(f),m=u.horizontalSize,p=u.verticalSize,v=u.latestIndex,h={};return u.supportFlexGap||("vertical"===a?o<v&&(h={marginBottom:m/(i?2:1)}):h=Object.assign(Object.assign({},o<v&&(0,n.Z)({},r,m/(i?2:1))),s&&{paddingBottom:p})),null===c||void 0===c?null:l.createElement(l.Fragment,null,l.createElement("div",{className:t,style:Object.assign(Object.assign({},h),d)},c),o<v&&i&&l.createElement("span",{className:"".concat(t,"-split"),style:h},i))},v=a(1294),h=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a},g={small:8,middle:16,large:24};var x=l.forwardRef((function(e,t){var a,r,u,f=l.useContext(d.E_),x=f.getPrefixCls,Z=f.space,j=f.direction,y=e.size,w=void 0===y?(null===Z||void 0===Z?void 0:Z.size)||"small":y,b=e.align,z=e.className,S=e.rootClassName,C=e.children,E=e.direction,O=void 0===E?"horizontal":E,k=e.prefixCls,N=e.split,P=e.style,M=e.wrap,I=void 0!==M&&M,A=e.classNames,D=e.styles,F=h(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),L=(0,s.Z)(),B=l.useMemo((function(){return(Array.isArray(w)?w:[w,w]).map((function(e){return function(e){return"string"===typeof e?g[e]:e||0}(e)}))}),[w]),G=(0,o.Z)(B,2),H=G[0],R=G[1],V=(0,i.Z)(C,{keepEmpty:!0}),T=void 0===b&&"horizontal"===O?"center":b,_=x("space",k),q=(0,v.Z)(_),U=(0,o.Z)(q,2),J=U[0],K=U[1],Q=c()(_,null===Z||void 0===Z?void 0:Z.className,K,"".concat(_,"-").concat(O),(a={},(0,n.Z)(a,"".concat(_,"-rtl"),"rtl"===j),(0,n.Z)(a,"".concat(_,"-align-").concat(T),T),a),z,S),W=c()("".concat(_,"-item"),null!==(r=null===A||void 0===A?void 0:A.item)&&void 0!==r?r:null===(u=null===Z||void 0===Z?void 0:Z.classNames)||void 0===u?void 0:u.item),X="rtl"===j?"marginLeft":"marginRight",Y=0,$=V.map((function(e,t){var a,n;null!==e&&void 0!==e&&(Y=t);var o=e&&e.key||"".concat(W,"-").concat(t);return l.createElement(p,{className:W,key:o,direction:O,index:t,marginDirection:X,split:N,wrap:I,style:null!==(a=null===D||void 0===D?void 0:D.item)&&void 0!==a?a:null===(n=null===Z||void 0===Z?void 0:Z.styles)||void 0===n?void 0:n.item},e)})),ee=l.useMemo((function(){return{horizontalSize:H,verticalSize:R,latestIndex:Y,supportFlexGap:L}}),[H,R,Y,L]);if(0===V.length)return null;var te={};return I&&(te.flexWrap="wrap",L||(te.marginBottom=-R)),L&&(te.columnGap=H,te.rowGap=R),J(l.createElement("div",Object.assign({ref:t,className:Q,style:Object.assign(Object.assign(Object.assign({},te),null===Z||void 0===Z?void 0:Z.style),P)},F),l.createElement(m,{value:ee},$)))}));var Z=x;Z.Compact=u.ZP;var j=Z}}]);
//# sourceMappingURL=119.e0fbabbf.chunk.js.map