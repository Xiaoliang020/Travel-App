"use strict";(self.webpackChunktravel_app=self.webpackChunktravel_app||[]).push([[445],{445:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var o=n(1413),r=n(3433),a=n(4165),l=n(5861),i=n(9439),s=n(2791),c=n(7993),u=(n(3508),n(2651)),d=n(7160),p=n(2958),f=n(7309),g=n(5925),h=n(2879),y=n(1913),m=n(3327),x=n(9286),Z=n(1515),v=n(2273),j=n(1891),w=n(8272),T=n(4215),k=n(2056),b=n(2365),C=n(9951),S=n(5498),P=n.n(S),L=n(3883),A=n(7106),O=n(184);function I(){var e=(0,s.useState)([]),t=(0,i.Z)(e,2),n=t[0],S=t[1],I=(0,s.useState)(!1),R=(0,i.Z)(I,2),D=R[0],F=R[1],E=(0,s.useState)(0),N=(0,i.Z)(E,2),M=N[0],_=N[1],z=(0,s.useState)({lat:null,lng:null}),G=(0,i.Z)(z,2),U=G[0],q=G[1],B=(0,s.useState)(!0),V=(0,i.Z)(B,2),W=V[0],Y=V[1],H=(0,s.useState)(null),K=(0,i.Z)(H,2),X=K[0],J=K[1],Q=(0,s.useState)(14),$=(0,i.Z)(Q,2),ee=$[0],te=$[1],ne=(0,s.useState)(null),oe=(0,i.Z)(ne,2),re=oe[0],ae=oe[1],le=(0,s.useState)(null),ie=(0,i.Z)(le,2),se=ie[0],ce=ie[1],ue=(0,s.useState)(""),de=(0,i.Z)(ue,2),pe=de[0],fe=de[1],ge=(0,s.useState)(null),he=(0,i.Z)(ge,2),ye=he[0],me=(he[1],(0,s.useState)(!1)),xe=(0,i.Z)(me,2),Ze=xe[0],ve=xe[1],je=(0,s.useState)(),we=(0,i.Z)(je,2),Te=we[0],ke=we[1],be=(0,s.useContext)(y.Z),Ce=be.addPath,Se=be.displayedPath,Pe=be.setDisplayedPath,Le=(0,s.useContext)(m.N).theme,Ae=function(e){return new Promise((function(t,n){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){return t(o.result)},o.onerror=function(e){return n(e)}}))},Oe=(0,s.useState)(!1),Ie=(0,i.Z)(Oe,2),Re=Ie[0],De=Ie[1],Fe=(0,s.useState)(""),Ee=(0,i.Z)(Fe,2),Ne=Ee[0],Me=Ee[1],_e=(0,s.useState)(""),ze=(0,i.Z)(_e,2),Ge=(ze[0],ze[1],function(){return De(!1)}),Ue=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,Ae(t.originFileObj);case 3:t.preview=e.sent;case 4:Me(t.url||t.preview),De(!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=(0,c.Db)({googleMapsApiKey:"AIzaSyAwnNq68eny2SDMxe4og-nRYvrB_jXAP-g"}).isLoaded,Be=(0,s.useState)(!1),Ve=(0,i.Z)(Be,2),We=Ve[0],Ye=Ve[1],He=(0,O.jsxs)("div",{children:[Ze?(0,O.jsx)(A.Z,{}):(0,O.jsx)(x.Z,{}),(0,O.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),Ke=function(e){"uploading"!==e.file.status?"done"===e.file.status&&(ke(URL.createObjectURL(e.file.originFileObj)),ve(!1)):ve(!0)};function Xe(){return new Promise((function(e,t){navigator.geolocation.getCurrentPosition((function(t){var n=t.coords,o=n.latitude,r=n.longitude;e({latitude:o,longitude:r})}),(function(e){t(e)}))}))}function Je(e){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,l.Z)((0,a.Z)().mark((function e(t){var n,o,l,i,s,c,u,d,p,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){e()}),1e3)}));case 2:return e.next=4,Xe();case 4:return n=e.sent,o=n.latitude,l=n.longitude,console.log({firstLat:o,firstLng:l}),e.next=10,new Promise((function(e){setTimeout((function(){e()}),1e3)}));case 10:return e.next=12,Xe();case 12:return i=e.sent,s=i.latitude,c=i.longitude,console.log({secondLat:s,secondLng:c}),e.next=18,new Promise((function(e){setTimeout((function(){e()}),1e3)}));case 18:return e.next=20,Xe();case 20:u=e.sent,d=u.latitude,p=u.longitude,console.log({thirdLat:d,thirdLng:p}),f={latitude:(o+s+d)/3,longitude:(l+c+p)/3},S((function(e){return[].concat((0,r.Z)(e),[{lat:f.latitude,lng:f.longitude,type:"default",pathId:t}])})),q({lat:f.latitude,lng:f.longitude}),console.log(f),ce(new Date);case 29:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}(0,s.useEffect)((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){J({lat:e.coords.latitude,lng:e.coords.longitude})}),(function(e){console.error("Error retrieving geolocation:",e),J({lat:40.7128,lng:-74.006})})):J({lat:40.7128,lng:-74.006})}),[]),(0,s.useEffect)((function(){Se&&Se.length>0?(J(Se[0]),te(15)):n.length>0&&J(n[n.length-1])}),[Se,n]),(0,s.useEffect)((function(){var e;return D&&(ae(new Date),navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,o=t.longitude;S((function(e){return[].concat((0,r.Z)(e),[{lat:n,lng:o,type:"default",pathId:M}])})),q({lat:n,lng:o}),console.log("Got first location after click the button")}),(function(e){console.error("Error retrieving geolocation:",e)})),e=setInterval((0,l.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Start Marking"),e.next=3,Je(M);case 3:console.log("Get a location"),console.log(M);case 5:case"end":return e.stop()}}),e)}))),8e3)),function(){return clearInterval(e)}}),[D,M]);L.Z.setApiKey("AIzaSyAwnNq68eny2SDMxe4og-nRYvrB_jXAP-g");var $e=function(){u.Z.confirm({title:"The comment you left in this place",content:(0,O.jsx)(d.Z,{placeholder:"Input something...",defaultValue:pe,onChange:function(e){return fe(e.target.value)}}),onOk:function(e){e()}})},et=n.reduce((function(e,t){return(e[t.pathId]=e[t.pathId]||[]).push(t),e}),{}),tt=function(){Y(!W)},nt=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(!0),t=document.querySelector(".map-container"),P()(t,{useCORS:!0,allowTaint:!0}).then((function(e){var t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="screenshot.png",t.click(),Ye(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=(0,l.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(!0),t=document.querySelector(".map-container"),P()(t,{useCORS:!0,allowTaint:!0}).then((function(e){e.toBlob((function(e){if(e){var t=new File([e],"screenshot.png",{type:"image/png"});navigator.share?navigator.share({files:[t]}):console.error("Web Share API not supported.")}else console.error("Failed to generate screenshot blob.");Ye(!1)}))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return qe?(0,O.jsx)("div",{className:"map-view",children:(0,O.jsxs)("div",{className:"map-container",children:[(0,O.jsxs)(c.b6,{center:X,zoom:ee,mapContainerClassName:"map-container",options:(0,o.Z)({fullscreenControl:!1,streetViewControl:!1},"default"===Le?{}:{fullscreenControl:!1,streetViewControl:!1,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}),children:[W&&Object.values(et).map((function(e,t){return(0,O.jsx)(c.dp,{path:e,options:{strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:5}},t)})),Se&&W&&(0,O.jsx)(c.dp,{path:Se,options:{strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:5}}),n.map((function(e,t){return(0,O.jsx)(c.jC,{position:e,visible:"custom"===e.type,icon:"custom"===e.type?ye:null,onClick:$e},t)}))]}),(0,O.jsx)("div",{className:"map-view-start-stop-button",children:D?(0,O.jsx)(f.ZP,{type:"primary",shape:"round",size:"large",onClick:function(){F(!1),console.log("Stop tracking");var e=(se-re)/1e3;e<10?u.Z.warning({centered:!0,title:"Warning",content:"The path is less than 10 seconds long and will not be saved."}):u.Z.confirm({centered:!0,title:"Do you want to save this path?",onOk:function(){var t=n[0],o=n[n.length-1];L.Z.fromLatLng(t.lat,t.lng).then((function(t){var r=t.results[0].formatted_address;L.Z.fromLatLng(o.lat,o.lng).then((function(t){var o=t.results[0].formatted_address;Ce({path:n,startTime:re,endTime:se,duration:e,startAddress:r,endAddress:o})})).catch((function(e){console.error("Error geocoding end coordinates:",e)}))})).catch((function(e){console.error("Error geocoding start coordinates:",e)}))}})},icon:(0,O.jsx)(Z.Z,{}),style:{backgroundColor:"OrangeRed"},children:"STOP"}):(0,O.jsx)(f.ZP,{type:"primary",shape:"round",size:"large",onClick:function(){S([]),F(!0),_(M+1),console.log("Start tracking")},icon:(0,O.jsx)(v.Z,{}),style:{backgroundColor:"LimeGreen"},children:"START"})}),(0,O.jsxs)(g.Z.Group,{shape:"circle",style:{left:24},children:[(0,O.jsx)(h.Z,{title:(0,O.jsxs)("div",{children:[(0,O.jsx)("h1",{children:"Your current location:"}),(0,O.jsxs)("p",{children:["Latitude: ",U.lat," "]}),(0,O.jsxs)("p",{children:["Longitude: ",U.lng]})]}),placement:"right",color:"#87d068",children:(0,O.jsx)(g.Z,{icon:(0,O.jsx)(j.Z,{})})}),(0,O.jsx)(g.Z.BackTop,{visibilityHeight:0})]}),(0,O.jsxs)(g.Z.Group,{shape:"circle",style:{right:50,top:"60%",transform:"translateY(-50%)"},children:[W?(0,O.jsx)(g.Z,{icon:(0,O.jsx)(w.Z,{}),tooltip:"Hide Paths",onClick:tt}):(0,O.jsx)(g.Z,{icon:(0,O.jsx)(T.Z,{}),tooltip:"Show Paths",onClick:tt}),(0,O.jsx)(g.Z,{icon:(0,O.jsx)(x.Z,{}),tooltip:"Add a Point",onClick:function(){var e=U.lat,t=U.lng;u.Z.confirm({title:"Set a New Marker",content:(0,O.jsxs)("div",{children:["Marker icon:",(0,O.jsx)(p.Z,{listType:"picture-circle",action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",onPreview:Ue,onChange:Ke,children:Te?(0,O.jsx)("img",{src:Te,alt:"avatar",style:{width:"100%"}}):He}),"Comment:",(0,O.jsx)(d.Z,{placeholder:"Input something...",defaultValue:pe,onChange:function(e){return fe(e.target.value)}}),(0,O.jsx)(u.Z,{open:Re,title:"The Marker Preview",footer:null,onCancel:Ge,children:(0,O.jsx)("img",{alt:"example",style:{width:"100%"},src:Ne})})]}),onOk:function(e){e()}});var n={lat:e,lng:t,type:"custom",id:Date.now()};S((function(e){return[].concat((0,r.Z)(e),[n])})),console.log("Add an information point")},disabled:!D}),(0,O.jsx)(g.Z,{icon:(0,O.jsx)(k.Z,{}),tooltip:"Clear",onClick:function(){S([]),_(0),Pe([])},disabled:D}),(0,O.jsx)(g.Z,{icon:(0,O.jsx)(b.Z,{}),tooltip:"Take Screenshot",onClick:nt,disabled:We}),(0,O.jsx)(g.Z,{icon:(0,O.jsx)(C.Z,{}),tooltip:"Share",onClick:ot,disabled:We})]})]})}):(0,O.jsx)("div",{children:"Loading.."})}}}]);
//# sourceMappingURL=445.3c530e54.chunk.js.map