{"version":3,"file":"static/js/701.81f3c76f.chunk.js","mappings":"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","sources":["views/Settings.js"],"sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport { Modal, Button, Card, Row, Col, message, Avatar, Upload } from 'antd';\r\nimport { UploadOutlined, UserOutlined } from '@ant-design/icons';\r\nimport { ThemeContext } from '../App';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport defaultImage from '../picture/Default.png'\r\nimport nightImage from '../picture/Night.png'\r\nimport ImgCrop from 'antd-img-crop'\r\nimport axios from 'axios';\r\n\r\nexport default function Settings() {\r\n    const { theme, setTheme } = useContext(ThemeContext);\r\n    const navigate = useNavigate();\r\n    const { Meta } = Card;\r\n    // State to store the user's avatarData\r\n    const [userAvatarData, setUserAvatarData] = useState(null);\r\n    // Get the user info stored in sessionStorage\r\n    const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n    const apiUrl = process.env.REACT_APP_API_BASE_URL;\r\n\r\n    // Fetch the user's avatarUrl when the component mounts\r\n    useEffect(() => {\r\n        // Make an API call to fetch the user data, including the avatarUrl\r\n        axios.get(`${apiUrl}/api/avatar/${user.id}`)\r\n        .then((response) => {\r\n            if (response.data.code === '0') {\r\n                const imageBase64 = response.data.data;\r\n                // Set the userAvatarUrl state with the fetched avatar data\r\n                setUserAvatarData(`data:image/png;base64,${imageBase64}`);\r\n            } else {\r\n                console.log(response.data.msg);\r\n            }\r\n        })\r\n        .catch((error) => {\r\n            console.error('Error fetching user data:', error);\r\n        });\r\n    }, []);\r\n\r\n    const handleThemeChange = (newTheme) => {\r\n        setTheme(newTheme);\r\n        message.success('Theme switched successfully!');\r\n    };\r\n\r\n    const handleAvatarChange = (info) => {\r\n        if (info.file.status === 'done') {\r\n            message.success(`${info.file.name} uploaded successfully`);\r\n        } else if (info.file.status === 'error') {\r\n            message.error(`${info.file.name} upload failed.`);\r\n        }\r\n    };\r\n\r\n    const customRequest = async ({ file, onSuccess, onError }) => {\r\n        try {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        // Change the URL to your backend endpoint that handles the avatar upload\r\n        const response = await axios.post(`${apiUrl}/api/${user.id}/upload-avatar`, formData);\r\n        if (response.data.code === '0') {\r\n            // Save the file URL or file ID returned by the backend\r\n            console.log('Avatar uploaded successfully:', response.data);\r\n            onSuccess();\r\n            window.location.reload();\r\n        } else {\r\n            onError(new Error('Failed to upload avatar'));\r\n        }\r\n        } catch (error) {\r\n            console.error('Error uploading avatar:', error);\r\n            onError(error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div style={{ textAlign: 'center' }}>\r\n                {/* Display the user's avatar if available, otherwise show the default user icon */}\r\n                {userAvatarData ? (\r\n                    <Avatar size={100} src={userAvatarData} />\r\n                ) : (\r\n                    <Avatar size={100} icon={<UserOutlined />} />\r\n                )}\r\n\r\n                <div style={{ marginTop: 16, marginBottom: 16 }}>\r\n                <ImgCrop\r\n                    rotationSlider={true}\r\n                    zoomSlider={true}\r\n                    quality={1}\r\n                    cropShape='round'\r\n                >\r\n                    <Upload customRequest={customRequest} showUploadList={false} onChange={handleAvatarChange}>\r\n                        <Button icon={<UploadOutlined />}>Upload Avatar</Button>\r\n                    </Upload>\r\n                </ImgCrop>\r\n                </div>\r\n            </div>\r\n\r\n            <div>\r\n                <Card title=\"Select Theme\">\r\n                    <Row gutter={16}>\r\n                        <Col span={12}>\r\n                            <Card\r\n                                hoverable\r\n                                style={{ flex: 1 }}\r\n                                cover={<img src={defaultImage} alt=\"Default Mode\" />}\r\n                                onClick={() => handleThemeChange('default')}\r\n                            >\r\n                                <Meta title=\"Default Mode\" />\r\n                            </Card>\r\n\r\n                        </Col>\r\n                        <Col span={12}>\r\n                            <Card\r\n                                hoverable\r\n                                style={{ flex: 1 }}\r\n                                cover={<img src={nightImage} alt=\"Night Mode\" />}\r\n                                onClick={() => handleThemeChange('dark')}\r\n                            >\r\n                                <Meta title=\"Night Mode\" />\r\n                            </Card>\r\n\r\n                        </Col>\r\n                    </Row>\r\n\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":["Settings","_useContext","useContext","ThemeContext","setTheme","theme","Meta","useNavigate","Card","_useState","useState","_useState2","_slicedToArray","userAvatarData","setUserAvatarData","user","JSON","parse","sessionStorage","getItem","apiUrl","process","useEffect","axios","get","concat","id","then","response","data","code","imageBase64","console","log","msg","catch","error","handleThemeChange","newTheme","message","success","customRequest","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","file","onSuccess","onError","formData","wrap","_context","prev","next","FormData","append","post","sent","window","location","reload","Error","t0","stop","_x","apply","arguments","_jsxs","children","style","textAlign","_jsx","Avatar","size","src","icon","UserOutlined","marginTop","marginBottom","ImgCrop","rotationSlider","zoomSlider","quality","cropShape","Upload","showUploadList","onChange","info","status","name","Button","UploadOutlined","title","Row","gutter","Col","span","hoverable","flex","cover","defaultImage","alt","onClick","nightImage"],"sourceRoot":""}