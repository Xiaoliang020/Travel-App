"use strict";(self.webpackChunktravel_app=self.webpackChunktravel_app||[]).push([[923],{5923:function(a,t,e){e.r(t),e.d(t,{default:function(){return x}});var n=e(3433),r=e(9439),c=e(2791),o=e(7689),s=e(3655),i=e(7027),l=e(2962),d=e(573),u=e(6005),h=e(7309),p=e(8715),f=e(1243),v=e(184),g=s.Z.Title,m=s.Z.Paragraph;function x(){var a=sessionStorage.getItem("user")||"{}",t=JSON.parse(a),e="https://travel-app.online:8443",s=(0,o.UO)().postId,x=(0,c.useState)(""),Z=(0,r.Z)(x,2),j=Z[0],y=Z[1],E=(0,c.useState)(null),N=(0,r.Z)(E,2),S=N[0],b=N[1],C=(0,c.useState)(!0),I=(0,r.Z)(C,2),P=I[0],k=I[1],w=(0,c.useState)([]),A=(0,r.Z)(w,2),R=A[0],D=A[1],O=function(){f.Z.get("".concat(e,"/api/post/").concat(s)).then((function(a){if("0"===a.data.code){var t;console.log(a.data);var r=a.data.data,c=null!==(t=a.data.data.comments)&&void 0!==t?t:[],o=f.Z.get("".concat(e,"/img/").concat(r.avatarid)).then((function(a){if("0"===a.data.code){var t=a.data.data;r.avatar="data:image/png;base64,".concat(t)}})).catch((function(a){console.error("Error fetching post avatar:",a)})),s=f.Z.get("".concat(e,"/api/screenshot/").concat(r.pathid)).then((function(a){if("0"===a.data.code){var t=a.data.data;r.screenshot="data:image/png;base64,".concat(t)}})).catch((function(a){console.error("Error fetching post avatar:",a)})),i=c.map((function(a){return f.Z.get("".concat(e,"/api/avatar/").concat(a.userid)).then((function(t){if("0"===t.data.code){var e=t.data.data;a.avatar="data:image/png;base64,".concat(e)}})).catch((function(a){console.error("Error fetching user avatar:",a)}))}));Promise.all([o,s].concat((0,n.Z)(i))).then((function(){c.sort((function(a,t){return new Date(a.createdAt)-new Date(t.createdAt)})),b(r),D(c),console.log(r.screenshot)})).catch((function(a){console.error("Error fetching user avatars:",a)}))}else console.log(a.data.msg);k(!1)})).catch((function(a){console.error("Error fetching post data:",a),k(!1)}))};(0,c.useEffect)((function(){O()}),[]);return P||!S?(0,v.jsx)("div",{children:"Loading..."}):(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"post-title",style:{textAlign:"left"},children:(0,v.jsx)(g,{level:2,children:S.title})}),(0,v.jsxs)("div",{className:"avatar-info-container",style:{display:"flex",alignItems:"center"},children:[(0,v.jsx)("div",{className:"avatar-container",style:{marginRight:"16px"},children:(0,v.jsx)(l.C,{src:S.avatar,size:64})}),(0,v.jsx)("div",{className:"post-username",children:(0,v.jsx)(g,{level:4,children:S.username})})]}),(0,v.jsx)("div",{className:"post-content",style:{textAlign:"left"},children:(0,v.jsx)(m,{children:S.content})}),(0,v.jsx)("div",{className:"post-screenshot",children:(0,v.jsx)(d.Z,{src:S.screenshot})}),(0,v.jsx)(u.Z.TextArea,{value:j,onChange:function(a){return y(a.target.value)},rows:4,placeholder:"Enter your reply..."}),(0,v.jsx)(h.ZP,{onClick:function(){var a={content:j,userid:t.id,username:t.username,avatarid:t.avatarUrl};f.Z.post("".concat(e,"/api/post/").concat(s,"/reply"),a).then((function(a){console.log(a.data),i.ZP.success("Reply added successfully!"),y(""),O()})).catch((function(a){console.error("Error adding reply:",a),i.ZP.error("Failed to add reply. Please try again later.")}))},children:"Reply"}),(0,v.jsx)(p.Z,{pagination:{position:"bottom",align:"center"},dataSource:R,renderItem:function(a,t){return(0,v.jsx)(p.Z.Item,{children:(0,v.jsx)(p.Z.Item.Meta,{avatar:(0,v.jsx)(l.C,{src:a.avatar}),title:a.username,description:a.content})})}})]})}}}]);
//# sourceMappingURL=923.50ab64ff.chunk.js.map