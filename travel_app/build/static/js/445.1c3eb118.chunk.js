"use strict";(self.webpackChunktravel_app=self.webpackChunktravel_app||[]).push([[445],{445:function(e,t,o){o.r(t),o.d(t,{default:function(){return P}});var n=o(1413),r=o(4165),l=o(3433),a=o(5861),s=o(9439),i=o(2791),c=o(7993),u=(o(3508),o(3152)),p=o(7309),d=o(5925),f=o(2879),g=o(1913),y=o(3327),h=o(1515),m=o(2273),x=o(1891),Z=o(8272),v=o(4215),T=o(9286),j=o(2056),k=o(2365),b=o(9951),w=o(5498),C=o.n(w),S=o(184);function P(){var e=(0,i.useState)([]),t=(0,s.Z)(e,2),o=t[0],w=t[1],P=(0,i.useState)(!1),L=(0,s.Z)(P,2),A=L[0],I=L[1],O=(0,i.useState)(0),D=(0,s.Z)(O,2),E=D[0],F=D[1],N=(0,i.useState)({lat:null,lng:null}),R=(0,s.Z)(N,2),G=R[0],z=R[1],_=(0,i.useState)(!0),q=(0,s.Z)(_,2),B=q[0],M=q[1],W=(0,i.useState)(null),Y=(0,s.Z)(W,2),H=Y[0],V=Y[1],K=(0,i.useState)(14),U=(0,s.Z)(K,2),X=U[0],J=U[1],Q=(0,i.useContext)(g.Z),$=Q.addPath,ee=Q.displayedPath,te=Q.setDisplayedPath,oe=(0,i.useContext)(y.N).theme,ne=(0,c.Db)({googleMapsApiKey:"AIzaSyAwnNq68eny2SDMxe4og-nRYvrB_jXAP-g"}).isLoaded,re=(0,i.useState)(!1),le=(0,s.Z)(re,2),ae=le[0],se=le[1];function ie(){return new Promise((function(e,t){navigator.geolocation.getCurrentPosition((function(t){var o=t.coords,n=o.latitude,r=o.longitude;e({latitude:n,longitude:r})}),(function(e){t(e)}))}))}function ce(e){return ue.apply(this,arguments)}function ue(){return ue=(0,a.Z)((0,r.Z)().mark((function e(t){var o,n,a,s,i,c,u,p,d,f;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:return o=e.sent,n=o.latitude,a=o.longitude,console.log({firstLat:n,firstLng:a}),e.next=8,new Promise((function(e){setTimeout((function(){e()}),1e3)}));case 8:return e.next=10,ie();case 10:return s=e.sent,i=s.latitude,c=s.longitude,console.log({secondLat:i,secondLng:c}),e.next=16,new Promise((function(e){setTimeout((function(){e()}),1e3)}));case 16:return e.next=18,ie();case 18:u=e.sent,p=u.latitude,d=u.longitude,console.log({thirdLat:p,thirdLng:d}),f={latitude:(n+i+p)/3,longitude:(a+c+d)/3},w((function(e){return[].concat((0,l.Z)(e),[{lat:f.latitude,lng:f.longitude,type:"default",pathId:t}])})),z({lat:f.latitude,lng:f.longitude}),console.log(f);case 26:case"end":return e.stop()}}),e)}))),ue.apply(this,arguments)}(0,i.useEffect)((function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){V({lat:e.coords.latitude,lng:e.coords.longitude})}),(function(e){console.error("Error retrieving geolocation:",e),V({lat:40.7128,lng:-74.006})})):V({lat:40.7128,lng:-74.006})}),[]),(0,i.useEffect)((function(){ee&&ee.length>0?(V(ee[0]),J(15)):o.length>0&&V(o[o.length-1])}),[ee,o]),(0,i.useEffect)((function(){var e;return A&&(navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,o=t.latitude,n=t.longitude;w((function(e){return[].concat((0,l.Z)(e),[{lat:o,lng:n,type:"default",pathId:E}])})),z({lat:o,lng:n}),console.log("Got first location after click the button")}),(function(e){console.error("Error retrieving geolocation:",e)})),e=setInterval((0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Start Marking"),e.next=3,ce(E);case 3:console.log("Get a location"),console.log(E);case 5:case"end":return e.stop()}}),e)}))),8e3)),function(){return clearInterval(e)}}),[A,E]);var pe=o.reduce((function(e,t){return(e[t.pathId]=e[t.pathId]||[]).push(t),e}),{}),de=function(){M(!B)},fe=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se(!0),t=document.querySelector(".map-container"),C()(t,{useCORS:!0,allowTaint:!0}).then((function(e){var t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="screenshot.png",t.click(),se(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se(!0),t=document.querySelector(".map-container"),C()(t,{useCORS:!0,allowTaint:!0}).then((function(e){e.toBlob((function(e){if(e){var t=new File([e],"screenshot.png",{type:"image/png"});navigator.share?navigator.share({files:[t]}):console.error("Web Share API not supported.")}else console.error("Failed to generate screenshot blob.");se(!1)}))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return ne?(0,S.jsx)("div",{className:"map-view",children:(0,S.jsxs)("div",{className:"map-container",children:[(0,S.jsxs)(c.b6,{center:H,zoom:X,mapContainerClassName:"map-container",options:(0,n.Z)({fullscreenControl:!1,streetViewControl:!1},"default"===oe?{}:{fullscreenControl:!1,streetViewControl:!1,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]}),children:[B&&Object.values(pe).map((function(e,t){return(0,S.jsx)(c.dp,{path:e,options:{strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:5}},t)})),ee&&B&&(0,S.jsx)(c.dp,{path:ee,options:{strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:5}}),o.map((function(e,t){return(0,S.jsx)(c.jC,{position:e,icon:"custom"===e.type?{url:"https://developers.google.com/maps/documentation/javascript/examples/full/images/info-i_maps.png"}:"invisable"},t)}))]}),(0,S.jsx)("div",{className:"map-view-start-stop-button",children:A?(0,S.jsx)(p.ZP,{type:"primary",shape:"round",size:"large",onClick:function(){I(!1),console.log("Stop tracking"),u.Z.confirm({centered:!0,title:"Do you want to save this path?",onOk:function(){$(o)}})},icon:(0,S.jsx)(h.Z,{}),style:{backgroundColor:"OrangeRed"},children:"STOP"}):(0,S.jsx)(p.ZP,{type:"primary",shape:"round",size:"large",onClick:function(){w([]),I(!0),F(E+1),console.log("Start tracking")},icon:(0,S.jsx)(m.Z,{}),style:{backgroundColor:"LimeGreen"},children:"START"})}),(0,S.jsxs)(d.Z.Group,{shape:"circle",style:{left:24},children:[(0,S.jsx)(f.Z,{title:(0,S.jsxs)("div",{children:[(0,S.jsx)("h1",{children:"Your current location:"}),(0,S.jsxs)("p",{children:["Latitude: ",G.lat," "]}),(0,S.jsxs)("p",{children:["Longitude: ",G.lng]})]}),placement:"right",color:"#87d068",children:(0,S.jsx)(d.Z,{icon:(0,S.jsx)(x.Z,{})})}),(0,S.jsx)(d.Z.BackTop,{visibilityHeight:0})]}),(0,S.jsxs)(d.Z.Group,{shape:"circle",style:{right:50,top:"60%",transform:"translateY(-50%)"},children:[B?(0,S.jsx)(d.Z,{icon:(0,S.jsx)(Z.Z,{}),tooltip:"Hide Paths",onClick:de}):(0,S.jsx)(d.Z,{icon:(0,S.jsx)(v.Z,{}),tooltip:"Show Paths",onClick:de}),(0,S.jsx)(d.Z,{icon:(0,S.jsx)(T.Z,{}),tooltip:"Add a Point",onClick:function(){var e={lat:G.lat,lng:G.lng,type:"custom",id:Date.now()};w((function(t){return[].concat((0,l.Z)(t),[e])})),console.log("Add an information point")},disabled:!A}),(0,S.jsx)(d.Z,{icon:(0,S.jsx)(j.Z,{}),tooltip:"Clear",onClick:function(){w([]),F(0),te([])},disabled:A}),(0,S.jsx)(d.Z,{icon:(0,S.jsx)(k.Z,{}),tooltip:"Take Screenshot",onClick:fe,disabled:ae}),(0,S.jsx)(d.Z,{icon:(0,S.jsx)(b.Z,{}),tooltip:"Share",onClick:ge,disabled:ae})]})]})}):(0,S.jsx)("div",{children:"Loading.."})}}}]);
//# sourceMappingURL=445.1c3eb118.chunk.js.map